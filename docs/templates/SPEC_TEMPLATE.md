# - Como criar o documeto SPEC definitivo

> ‚ö†Ô∏è **Fixar o padr√£o ‚Äúmais completo poss√≠vel‚Äù como baseline:**

Nunca entregar apenas o m√≠nimo, mas sempre trazer todas as valida√ß√µes, limita√ß√µes, integra√ß√µes pipeline, exemplos multi-cen√°rio, tipos, edge cases, comportamento de terceiros (pandas/numpy), e detalhar toda a tabela de entradas/sa√≠das como ‚Äúesperado para produ√ß√£o‚Äù.

Checklist sempre preenchido e hist√≥rico detalhado, mesmo quando ainda pendente de revis√£o.

Benchmarks reais e integra√ß√£o como default, n√£o como exce√ß√£o.

---

# [NomeDoModulo] ‚Äî Especifica√ß√£o T√©cnica (SPEC.md)

> ‚ö†Ô∏è **IMPORTANTE**: Este template deve ser preenchido **AP√ìS** a implementa√ß√£o do c√≥digo estar completa. Validar constantemente contra o c√≥digo real durante o preenchimento.

## Docstring Padr√£o do Projeto

```python
"""
src/[caminho]/[nome_do_modulo].py
[Descri√ß√£o concisa do m√≥dulo e sua responsabilidade no sistema Op_Trader]
Autor: Equipe Op_Trader
Data: [YYYY-MM-DD]
"""
```

---

## 1. Objetivo

[Descri√ß√£o clara do prop√≥sito e responsabilidades do m√≥dulo no contexto do sistema Op_Trader]

**Funcionalidades principais:**
- [Funcionalidade 1]
- [Funcionalidade 2]
- [Funcionalidade N]

---

## 2. Entradas

> üìã **VALIDA√á√ÉO**: Conferir se todos os par√¢metros de `__init__` est√£o documentados aqui.

| Par√¢metro | Tipo | Obrigat√≥rio | Descri√ß√£o | Exemplo |
|-----------|------|-------------|-----------|---------|
| param1 | type | Sim/N√£o | Descri√ß√£o do par√¢metro | valor_exemplo |

---

## 3. Sa√≠das

> üìã **VALIDA√á√ÉO**: Conferir se TODOS os m√©todos p√∫blicos est√£o listados aqui com assinaturas EXATAS do c√≥digo.

| Fun√ß√£o/M√©todo | Tipo Retorno | Descri√ß√£o | Exemplo |
|---------------|--------------|-----------|---------|
| method_name | return_type | Descri√ß√£o da sa√≠da | exemplo_uso |

> ‚ö†Ô∏è **ATEN√á√ÉO**: Sempre incluir `self` como primeiro par√¢metro em m√©todos de classe.

---

## 4. Performance e Complexidade

> üìã **VALIDA√á√ÉO**: Testar performance real antes de documentar. N√£o inventar n√∫meros.

| M√©todo/Fun√ß√£o | Complexidade Temporal | Complexidade Espacial | Observa√ß√µes |
|---------------|----------------------|----------------------|-------------|
| method_name | O(n) | O(1) | Notas sobre performance |

**Benchmarks esperados:**
- [M√©todo]: ~X ms para dataset de Y registros *(testado em [data/ambiente])*
- [Opera√ß√£o]: ~Z opera√ß√µes/segundo em hardware padr√£o *(especificar config)*

**Limita√ß√µes conhecidas:**
- [Limita√ß√£o 1 e como contornar]
- [Limita√ß√£o 2 e impacto esperado]

---

## 5. Exce√ß√µes e Valida√ß√µes

> üìã **VALIDA√á√ÉO CR√çTICA**: Testar TODAS as exce√ß√µes listadas aqui. Se n√£o est√£o implementadas, N√ÉO documentar.

| Caso | Exce√ß√£o/Retorno | Descri√ß√£o |
|------|-----------------|-----------|
| Caso de erro | ExceptionType | Descri√ß√£o do erro e quando ocorre |

> ‚ö†Ô∏è **REGRA**: S√≥ documentar exce√ß√µes que est√£o realmente implementadas no c√≥digo.

---

## 6. Depend√™ncias e Compatibilidade

> üìã **VALIDA√á√ÉO**: Conferir imports no c√≥digo real e testar vers√µes m√≠nimas.

**Depend√™ncias obrigat√≥rias:**
- `biblioteca>=vers√£o_minima` - Prop√≥sito da depend√™ncia
- `src.modulo.submodulo` - Integra√ß√£o interna

**Depend√™ncias opcionais:**
- `biblioteca_opcional>=vers√£o` - Funcionalidade adicional

**Compatibilidade testada:**
- Python: 3.8+
- Pandas: 1.3.0+
- NumPy: 1.20.0+

**N√£o deve depender de:**
- [M√≥dulos que devem ser evitados]
- [Bibliotecas que criam acoplamento desnecess√°rio]

---

## 7. Docstring Padr√£o (Google Style)

> ‚ö†Ô∏è **ATEN√á√ÉO CR√çTICA**: Copiar assinaturas EXATAS do c√≥digo, incluindo `self` e todos os par√¢metros com defaults.

```python
class [NomeClasse]:
    """
    [Descri√ß√£o da classe]

    M√©todos principais:
      - method1: Descri√ß√£o breve
      - method2: Descri√ß√£o breve

    Args:
        param (type): Descri√ß√£o do par√¢metro de inicializa√ß√£o.
    """

    def method_name(self, param1: type, param2: type = default) -> return_type:
        """
        [Descri√ß√£o do m√©todo]
        
        Args:
            param1 (type): Descri√ß√£o do par√¢metro.
            param2 (type, optional): Descri√ß√£o do par√¢metro opcional. Defaults to default.
        
        Returns:
            return_type: Descri√ß√£o do retorno.
        
        Raises:
            ExceptionType: Condi√ß√£o que causa a exce√ß√£o.
        
        Example:
            >>> instance = [NomeClasse]()
            >>> result = instance.method_name(value1, value2)
            >>> print(result)
            expected_output
        """
```

> üìã **PROCESSO OBRIGAT√ìRIO**: 
> 1. Copiar a assinatura exata do c√≥digo
> 2. Documentar TODOS os par√¢metros opcionais com seus defaults
> 3. Testar o exemplo fornecido

---

## 8. Exemplos de Uso

> üìã **VALIDA√á√ÉO**: TESTAR todos os exemplos antes de documentar. C√≥digo que n√£o roda √© inaceit√°vel.

### Uso B√°sico
```python
from src.[caminho].[modulo] import [Classe]

# Exemplo simples
instance = [Classe]()
result = instance.method_name(param1)
```

### Uso Avan√ßado
```python
# Exemplo com m√∫ltiplos par√¢metros
instance = [Classe](debug=True)
result = instance.advanced_method(param1, param2, optional_param=value)
```

### Uso em Pipeline
```python
# Exemplo de integra√ß√£o com outros m√≥dulos
from src.pipeline import Pipeline

pipeline = Pipeline()
calculator = [Classe]()
result = pipeline.process(data, calculator.method_name)
```

### Tratamento de Erros
```python
try:
    result = instance.method_name(invalid_param)
except SpecificError as e:
    logger.error(f"Erro espec√≠fico: {e}")
except Exception as e:
    logger.error(f"Erro inesperado: {e}")
```

> ‚ö†Ô∏è **REGRA**: Todos os exemplos devem ser testados e funcionais.

---

## 9. Configura√ß√£o e Customiza√ß√£o

### Par√¢metros de Configura√ß√£o
```python
# Configura√ß√£o via arquivo
config = {
    "parameter1": default_value,
    "parameter2": alternative_value,
    "debug_mode": False
}

instance = [Classe](config=config)
```

### Configura√ß√£o Avan√ßada
```python
# Configura√ß√£o para diferentes ambientes
DEV_CONFIG = {...}
PROD_CONFIG = {...}

instance = [Classe](config=PROD_CONFIG)
```

---

## 10. Regras de Neg√≥cio e Observa√ß√µes

- **Regra 1:** Descri√ß√£o da regra e sua import√¢ncia
- **Comportamento especial:** Situa√ß√µes onde o m√≥dulo tem comportamento diferenciado
- **Integra√ß√£o:** Como o m√≥dulo se integra com outros componentes
- **Thread safety:** Se aplic√°vel, comportamento em ambiente multi-thread
- **Estado:** Como o m√≥dulo gerencia estado interno

---

## 11. Edge Cases e Cen√°rios Especiais

> üìã **VALIDA√á√ÉO**: Testar todos os edge cases documentados.

| Cen√°rio | Comportamento Esperado | Observa√ß√µes |
|---------|----------------------|-------------|
| Input vazio | Retorna valor padr√£o ou exception | Como lidar |
| Input muito grande | Performance degradada ou limita√ß√£o | Thresholds |
| Valores None/NaN | Tratamento espec√≠fico | Estrat√©gia adotada |

**Cen√°rios de stress:**
- **Volume alto:** Como o m√≥dulo se comporta com grandes volumes de dados
- **Chamadas frequentes:** Performance em uso intensivo
- **Recursos limitados:** Comportamento em ambiente com pouca mem√≥ria

---

## 12. Testes e Valida√ß√£o

### Casos de Teste Obrigat√≥rios
- [x] Inputs v√°lidos com valores t√≠picos
- [x] Inputs v√°lidos com valores extremos
- [x] Inputs inv√°lidos com tratamento de erro
- [x] Edge cases identificados
- [x] Performance com datasets grandes
- [x] Integra√ß√£o com outros m√≥dulos

### M√©tricas de Qualidade
- Cobertura de c√≥digo: > 90%
- Tempo de execu√ß√£o: < X ms para opera√ß√£o t√≠pica
- Uso de mem√≥ria: < Y MB para dataset padr√£o

---

## 13. Monitoramento e Logging

### N√≠veis de Log
- **DEBUG:** Traces detalhados de execu√ß√£o
- **INFO:** Opera√ß√µes importantes e marcos
- **WARNING:** Situa√ß√µes que merecem aten√ß√£o
- **ERROR:** Erros que impedem opera√ß√£o normal

### M√©tricas Importantes
- Tempo de execu√ß√£o por opera√ß√£o
- Taxa de erro por tipo de input
- Uso de recursos (CPU/mem√≥ria)
- Throughput (opera√ß√µes/segundo)

---

## 14. Checklist de Qualidade (conforme CONTRIBUTING.md)

> ‚ö†Ô∏è **OBRIGAT√ìRIO**: Todos os itens devem ser verificados antes de finalizar a spec.

### Valida√ß√£o de C√≥digo
- [ ] C√≥digo segue PEP 8 e conven√ß√µes do projeto
- [ ] Imports absolutos utilizando `src.` como raiz
- [ ] Type hints em todas as fun√ß√µes p√∫blicas
- [ ] Nomenclatura consistente (snake_case para fun√ß√µes, PascalCase para classes)

### Valida√ß√£o de Documenta√ß√£o
- [ ] Docstrings padr√£o Google em todas as fun√ß√µes/classes p√∫blicas
- [ ] **CR√çTICO**: Todas as assinaturas incluem `self` em m√©todos de classe
- [ ] **CR√çTICO**: Todos os par√¢metros opcionais est√£o documentados com defaults
- [ ] Exemplos de uso documentados e **TESTADOS**

### Valida√ß√£o de Qualidade
- [ ] Testes para inputs v√°lidos, edge cases e tratamento de erros
- [ ] **CR√çTICO**: Todas as exce√ß√µes documentadas est√£o implementadas
- [ ] Logging implementado em n√≠veis apropriados
- [ ] Tratamento expl√≠cito de erros com exce√ß√µes customizadas
- [ ] Cobertura de testes > 90% comprovada
- [ ] Performance documentada e **TESTADA**
- [ ] Compatibilidade de vers√µes especificada e **TESTADA**

---

## 15. Valida√ß√£o Final Spec-C√≥digo

> üîç **CHECKLIST OBRIGAT√ìRIO**: Completar antes de finalizar a especifica√ß√£o.

### Sincroniza√ß√£o com C√≥digo
- [ ] **Assinaturas**: Todas as assinaturas de m√©todos conferem exatamente com o c√≥digo
- [ ] **Par√¢metros**: Todos os par√¢metros opcionais est√£o documentados com valores default corretos
- [ ] **Exce√ß√µes**: Todas as exce√ß√µes mencionadas est√£o realmente implementadas no c√≥digo
- [ ] **Imports**: Todas as depend√™ncias listadas est√£o nos imports do c√≥digo
- [ ] **Exemplos**: Todos os exemplos foram testados e funcionam

### Valida√ß√£o de Qualidade
- [ ] **Performance**: Benchmarks documentados foram medidos, n√£o estimados
- [ ] **Edge Cases**: Todos os cen√°rios especiais foram testados
- [ ] **Integra√ß√£o**: Exemplos de pipeline foram testados com outros m√≥dulos
- [ ] **Documenta√ß√£o**: Revis√£o t√©cnica foi feita por outro desenvolvedor

### Aprova√ß√£o Final
- [ ] **Revisor t√©cnico**: [Nome] - Data: [YYYY-MM-DD]
- [ ] **Teste de integra√ß√£o**: Passou nos testes de CI/CD
- [ ] **Documenta√ß√£o**: Sem inconsist√™ncias identificadas

---

## 16. Hist√≥rico

| Data | Autor | Altera√ß√£o |
|------|-------|-----------|
| YYYY-MM-DD | Equipe Op_Trader | Cria√ß√£o inicial |

---

## üö® PROCESSO OBRIGAT√ìRIO PARA USO DO TEMPLATE

### Antes de Come√ßar:
1. ‚úÖ **C√≥digo deve estar 100% implementado**
2. ‚úÖ **Testes b√°sicos devem estar passando**
3. ‚úÖ **Revisor t√©cnico deve estar designado**

### Durante o Preenchimento:
1. üîÑ **Validar cada se√ß√£o contra o c√≥digo real**
2. üß™ **Testar todos os exemplos fornecidos**
3. üìä **Medir performance real, n√£o estimar**
4. üîç **Conferir assinaturas car√°ter por car√°ter**

### Antes de Finalizar:
1. ‚úÖ **Completar checklist de valida√ß√£o final**
2. üë• **Revis√£o t√©cnica obrigat√≥ria**
3. üß™ **Todos os exemplos testados e funcionais**
4. üìã **Nenhum item "TODO" ou placeholder restante**

### Ap√≥s Finaliza√ß√£o:
1. üîÑ **Manter sincroniza√ß√£o com mudan√ßas no c√≥digo**
2. üìà **Atualizar benchmarks periodicamente**
3. üêõ **Reportar inconsist√™ncias encontradas**

---

## ‚ö†Ô∏è ARMADILHAS COMUNS A EVITAR

### üö´ **NUNCA FA√áA:**
- Documentar exce√ß√µes que n√£o est√£o implementadas
- Omitir `self` em assinaturas de m√©todos
- Copiar exemplos sem testar
- Inventar benchmarks de performance
- Deixar par√¢metros opcionais sem documentar
- Finalizar sem revis√£o t√©cnica

### ‚úÖ **SEMPRE FA√áA:**
- Testar todos os exemplos
- Validar assinaturas contra c√≥digo
- Medir performance real
- Documentar todos os par√¢metros
- Implementar antes de documentar
- Solicitar revis√£o t√©cnica

---

## üìÅ Estrutura de Pastas Sugerida

```
docs/
‚îú‚îÄ‚îÄ specs/
‚îÇ   ‚îú‚îÄ‚îÄ SPEC_[modulo1].md
‚îÇ   ‚îú‚îÄ‚îÄ SPEC_[modulo2].md
‚îÇ   ‚îî‚îÄ‚îÄ SPEC_[seu_modulo].md
‚îî‚îÄ‚îÄ templates/
    ‚îî‚îÄ‚îÄ SPEC_template.md (este arquivo)
```

---

## üí° DICAS PARA SUCESSO

1. **Implemente primeiro, documente depois**
2. **Teste tudo que documentar**
3. **Pe√ßa revis√£o t√©cnica sempre**
4. **Mantenha sincroniza√ß√£o constante**
5. **Seja preciso, n√£o criativo**
6. **Valide contra o c√≥digo real**
7. **N√£o invente informa√ß√µes**

Este template melhorado incorpora valida√ß√µes expl√≠citas, checklists obrigat√≥rios e processos que reduzem drasticamente a chance de inconsist√™ncias entre especifica√ß√£o e implementa√ß√£o.